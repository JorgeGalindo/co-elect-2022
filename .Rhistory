group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-04-28")
promedio_3 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-04-23" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-04-22")
promedio_13 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-04-22" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-04-21")
promedio_14 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-04-20" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-04-19")
promedio_4 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-04-14" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-04-13")
promedio_5 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-04-08" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-04-07")
promedio_6 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-04-06" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-04-05")
promedio_7 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-04-04" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-04-03")
promedio_8 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-04-03" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-04-02")
promedio_9 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-03-30" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-03-29")
promedio_10 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-03-22" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-03-21")
promedio_11 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-03-21" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-03-20")
promedio_12 <- promedio_raw_pre_df %>%
mutate(promedio=promedio_pre) %>%
mutate(fecha="2022-03-12") %>%
select(-promedio_pre)
promedio_evol_df <- promedio_raw_df %>%
mutate(fecha="2022-05-17") %>%
rbind(promedio_1) %>%
rbind(promedio_2) %>%
rbind(promedio_3) %>%
rbind(promedio_4) %>%
rbind(promedio_5) %>%
rbind(promedio_6) %>%
rbind(promedio_7) %>%
rbind(promedio_8) %>%
rbind(promedio_9) %>%
rbind(promedio_10) %>%
rbind(promedio_11) %>%
rbind(promedio_12) %>%
rbind(promedio_13) %>%
rbind(promedio_14) %>%
rbind(promedio_15) %>%
pivot_wider(names_from = candidato, values_from = promedio)
promedio_evol <- tabla_dw %>%
mutate(fecha=as.character(X.1)) %>%
left_join(promedio_evol_df)
View(promedio_evol)
View(promedio_evol_df)
promedio_20 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-05-17" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-05-16")
promedio_19 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-05-16" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-05-15")
promedio_18 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-05-13" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-05-12")
promedio_17 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-05-11" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-05-10")
promedio_16 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-05-05" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-05-04")
promedio_15 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-05-02" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-05-01")
promedio_1 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-04-30" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-04-29")
promedio_2 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-04-29" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-04-28")
promedio_3 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-04-23" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-04-22")
promedio_13 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-04-22" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-04-21")
promedio_14 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-04-20" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-04-19")
promedio_4 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-04-14" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-04-13")
promedio_5 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-04-08" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-04-07")
promedio_6 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-04-06" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-04-05")
promedio_7 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-04-04" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-04-03")
promedio_8 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-04-03" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-04-02")
promedio_9 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-03-30" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-03-29")
promedio_10 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-03-22" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-03-21")
promedio_11 <- clean_df %>%
#escogiendo las que son
filter(fecha<"2022-03-21" & fecha>"2022-03-12") %>% #campo post-consultas
select(encuestadora,candidato,int_voto_raw,fecha)  %>%
pivot_wider(names_from="candidato", values_from="int_voto_raw") %>%
group_by(encuestadora) %>%
slice_tail() %>%
ungroup() %>%
#introduciendo valor ponderado
pivot_longer(cols = contains("_"),
names_to = "candidato", values_to = "int_voto_raw") %>%
left_join(ponderador_df) %>%
group_by(candidato) %>%
summarize(promedio=weighted.mean(int_voto_raw,ponderador)) %>%
mutate(fecha="2022-03-20")
promedio_12 <- promedio_raw_pre_df %>%
mutate(promedio=promedio_pre) %>%
mutate(fecha="2022-03-12") %>%
select(-promedio_pre)
promedio_evol_df <- promedio_raw_df %>%
mutate(fecha="2022-05-17") %>%
rbind(promedio_1) %>%
rbind(promedio_2) %>%
rbind(promedio_3) %>%
rbind(promedio_4) %>%
rbind(promedio_5) %>%
rbind(promedio_6) %>%
rbind(promedio_7) %>%
rbind(promedio_8) %>%
rbind(promedio_9) %>%
rbind(promedio_10) %>%
rbind(promedio_11) %>%
rbind(promedio_12) %>%
rbind(promedio_13) %>%
rbind(promedio_14) %>%
rbind(promedio_15) %>%
rbind(promedio_16) %>%
rbind(promedio_17) %>%
rbind(promedio_18) %>%
rbind(promedio_19) %>%
rbind(promedio_20) %>%
pivot_wider(names_from = candidato, values_from = promedio)
promedio_evol <- tabla_dw %>%
mutate(fecha=as.character(X.1)) %>%
left_join(promedio_evol_df)
write_csv(promedio_evol,"promedio_evol.csv")
View(promedio_raw_df)
